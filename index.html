<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lakhani AI - High Performance Poster Maker</title>
    <style>
        :root { --primary: #003399; --accent: #FFC107; --bg: #f0f2f5; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        .sidebar { width: 340px; background: white; border-right: 1px solid #ddd; padding: 25px; display: flex; flex-direction: column; gap: 15px; box-shadow: 2px 0 10px rgba(0,0,0,0.05); overflow-y: auto; }
        .preview-area { flex: 1; display: flex; align-items: center; justify-content: center; padding: 20px; background: #dfe4ea; }
        canvas { max-height: 95vh; max-width: 100%; border-radius: 8px; box-shadow: 0 20px 60px rgba(0,0,0,0.2); cursor: move; }

        .input-group { display: flex; flex-direction: column; gap: 5px; }
        label { font-size: 11px; font-weight: bold; color: #666; text-transform: uppercase; }
        input[type="text"], input[type="range"] { padding: 10px; border: 1px solid #ddd; border-radius: 6px; }
        
        button { background: var(--primary); color: white; border: none; padding: 15px; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 16px; margin-top: 10px; }
        button:hover { background: #002266; }

        /* Professional Loader */
        .loader-overlay { position: fixed; inset: 0; background: rgba(0,0,30,0.9); color: white; display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; }
        .spinner { width: 50px; height: 50px; border: 5px solid rgba(255,255,255,0.1); border-top: 5px solid var(--accent); border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 15px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .status-msg { text-align: center; }
    </style>
</head>
<body>

<div id="loader" class="loader-overlay">
    <div class="spinner"></div>
    <div class="status-msg">
        <b style="font-size: 20px;">AI is Processing...</b><br>
        <span style="opacity: 0.7;">Removing background via Hugging Face Cloud AI</span>
    </div>
</div>

<div class="sidebar">
    <h1 style="color: var(--primary); text-align: center; margin: 0 0 10px 0;">VARDAAN AI</h1>
    <hr style="border:0; border-top: 1px solid #eee;">

    <div class="input-group">
        <label>1. Upload Logo</label>
        <input type="file" id="logoLoader" accept="image/*">
    </div>

    <div class="input-group">
        <label>2. Upload Shoe Photo</label>
        <input type="file" id="imageLoader" accept="image/*">
    </div>

    <div class="input-group">
        <label>Shoe Scale</label>
        <input type="range" id="sizeSlider" min="10" max="250" value="85">
    </div>

    <div class="input-group">
        <label>Product Code</label>
        <input type="text" id="prodName" value="#LAK-PRO-2026">
    </div>

    <div class="input-group">
        <label>Price Text</label>
        <input type="text" id="prodPrice" value="â‚¹ 549.00">
    </div>

    <button onclick="downloadImage()">Download HD Poster</button>
    <p style="font-size: 11px; color: #999; text-align: center; line-height: 1.4;">
        AI processing takes 3-5 seconds.<br>Drag the shoe on the canvas to position it.
    </p>
</div>

<div class="preview-area">
    <canvas id="posterCanvas" width="800" height="1000"></canvas>
</div>

<script>
    const HF_TOKEN = "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"; // Using your token
    const canvas = document.getElementById('posterCanvas');
    const ctx = canvas.getContext('2d');
    const loader = document.getElementById('loader');

    let productImg = null, logoImg = null;
    let prodX = 400, prodY = 550;
    let isDragging = false;

    // --- HUGGING FACE AI LOGIC ---
    document.getElementById('imageLoader').onchange = async (e) => {
        const file = e.target.files[0];
        if (!file) return;

        loader.style.display = 'flex';

        try {
            const response = await fetch(
                "https://api-inference.huggingface.co/models/briaai/RMBG-1.4",
                {
                    headers: { 
                        "Authorization": `Bearer ${HF_TOKEN}`,
                        "Content-Type": "application/octet-stream"
                    },
                    method: "POST",
                    body: file,
                }
            );

            if (!response.ok) throw new Error("AI Server Busy. Try again in a few seconds.");

            const blob = await response.blob();
            const img = new Image();
            img.onload = () => {
                productImg = img;
                drawPoster();
                loader.style.display = 'none';
            };
            img.src = URL.createObjectURL(blob
